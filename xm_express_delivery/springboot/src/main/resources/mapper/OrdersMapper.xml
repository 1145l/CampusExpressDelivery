<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.mapper.OrdersMapper">

    <select id="selectAll" resultType="com.example.entity.Orders">
        select orders.*, s1.name as courierName, s1.avatar as courierAvatar, s2.name as studentName,
        identification.phone as courierPhone,
        express_type.name as typeName from `orders`
        left join student s1 on orders.courier_id = s1.id
        left join student s2 on orders.student_id = s2.id
        left join express_type on orders.express_type = express_type.id
        left join identification on orders.courier_id = identification.student_id
        <where>
            <if test="orderNo != null"> and orders.order_no like concat('%', #{orderNo}, '%')</if>
            <if test="status != null"> and orders.status = #{status}</if>
            <if test="expressType != null"> and orders.express_type = #{expressType}</if>
            <if test="studentId != null"> and orders.student_id = #{studentId}</if>
            <if test="courierId != null"> and orders.courier_id = #{courierId}</if>
        </where>
        order by orders.id desc
    </select>

    <select id="selectById" resultType="com.example.entity.Orders">
        select orders.*, s1.name as courierName, s1.avatar as courierAvatar, s2.name as studentName,
               identification.phone as courierPhone,
               express_type.name as typeName from `orders`
        left join student s1 on orders.courier_id = s1.id
        left join student s2 on orders.student_id = s2.id
        left join express_type on orders.express_type = express_type.id
        left join identification on orders.courier_id = identification.student_id
        where orders.id = #{id}
    </select>

    <select id="selectByOrderNo" resultType="com.example.entity.Orders">
        select orders.*, s1.name as courierName, s1.avatar as courierAvatar, s2.name as studentName,
               identification.phone as courierPhone,
               express_type.name as typeName from `orders`
                                                      left join student s1 on orders.courier_id = s1.id
                                                      left join student s2 on orders.student_id = s2.id
                                                      left join express_type on orders.express_type = express_type.id
                                                      left join identification on orders.courier_id = identification.student_id
        where orders.order_no = #{orderNo}
    </select>


    <delete id="deleteById">
        delete from `orders`
        where id = #{id}
    </delete>

    <insert id="insert" parameterType="com.example.entity.Orders" useGeneratedKeys="true">
        insert into orders
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">id,</if>
            <if test="orderNo != null">order_no,</if>
            <if test="courierId != null">courier_id,</if>
            <if test="studentId != null">student_id,</if>
            <if test="expressType != null">express_type,</if>
            <if test="price != null">price,</if>
            <if test="tip != null">tip,</if>
            <if test="descr != null">descr,</if>
            <if test="pickupAddress != null">pickup_address,</if>
            <if test="shippingAddress != null">shipping_address,</if>
            <if test="customerName != null">customer_name,</if>
            <if test="phone != null">phone,</if>
            <if test="pickupCode != null">pickup_code,</if>
            <if test="createTime != null">create_time,</if>
            <if test="accessTime != null">access_time,</if>
            <if test="deliverTime != null">deliver_time,</if>
            <if test="signTime != null">sign_time,</if>
            <if test="rate != null">rate,</if>
            <if test="feedback != null">feedback,</if>
            <if test="status != null">status,</if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">#{id},</if>
            <if test="orderNo != null">#{orderNo},</if>
            <if test="courierId != null">#{courierId},</if>
            <if test="studentId != null">#{studentId},</if>
            <if test="expressType != null">#{expressType},</if>
            <if test="price != null">#{price},</if>
            <if test="tip != null">#{tip},</if>
            <if test="descr != null">#{descr},</if>
            <if test="pickupAddress != null">#{pickupAddress},</if>
            <if test="shippingAddress != null">#{shippingAddress},</if>
            <if test="customerName != null">#{customerName},</if>
            <if test="phone != null">#{phone},</if>
            <if test="pickupCode != null">#{pickupCode},</if>
            <if test="createTime != null">#{createTime},</if>
            <if test="accessTime != null">#{accessTime},</if>
            <if test="deliverTime != null">#{deliverTime},</if>
            <if test="signTime != null">#{signTime},</if>
            <if test="rate != null">#{rate},</if>
            <if test="feedback != null">#{feedback},</if>
            <if test="status != null">#{status},</if>
        </trim>
    </insert>

    <update id="updateById" parameterType="com.example.entity.Orders">
        update orders
        <set>
            <if test="orderNo != null">
                order_no = #{orderNo},
            </if>
            <if test="courierId != null">
                courier_id = #{courierId},
            </if>
            <if test="studentId != null">
                student_id = #{studentId},
            </if>
            <if test="expressType != null">
                express_type = #{expressType},
            </if>
            <if test="price != null">
                price = #{price},
            </if>
            <if test="tip != null">
                tip = #{tip},
            </if>
            <if test="descr != null">
                descr = #{descr},
            </if>
            <if test="pickupAddress != null">
                pickup_address = #{pickupAddress},
            </if>
            <if test="shippingAddress != null">
                shipping_address = #{shippingAddress},
            </if>
            <if test="customerName != null">
                customer_name = #{customerName},
            </if>
            <if test="phone != null">
                phone = #{phone},
            </if>
            <if test="pickupCode != null">
                pickup_code = #{pickupCode},
            </if>
            <if test="createTime != null">
                create_time = #{createTime},
            </if>
            <if test="accessTime != null">
                access_time = #{accessTime},
            </if>
            <if test="deliverTime != null">
                deliver_time = #{deliverTime},
            </if>
            <if test="signTime != null">
                sign_time = #{signTime},
            </if>
            <if test="rate != null">
                rate = #{rate},
            </if>
            <if test="feedback != null">
                feedback = #{feedback},
            </if>
            <if test="status != null">
                status = #{status},
            </if>
        </set>
        where id = #{id}
    </update>

</mapper>